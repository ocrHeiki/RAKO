# üõ°Ô∏è S√ºsteemi Kaitsmise Juhend: Samm-Sammult Soovitused

See juhend pakub praktilisi samme s√ºsteemi kaitsmiseks samas j√§rjekorras, milles r√ºnnakud toimusid praktikumis. Kaitsmine tugineb standardsetele IT-turbe praktikatele, nagu uuendused, konfiguratsioonid ja t√∂√∂riistad. Rakenda neid j√§rjest, et v√§hendada haavatavusi.

## 1. Privilege Escalation Kaitse (Ubuntu Server)
Privilege escalation r√ºnnakud (nt CVE-2025-32463 exploit) v√µivad anda root-√µigusi. Kaitse nii:
- **Uuenda s√ºsteemi regulaarselt**: K√§ivita `sudo apt update && sudo apt upgrade`, et paigaldada turvapaigad kerneli ja tarkvara jaoks.
- **Piira sudo √µigusi**: Kasuta `sudo visudo`, et lisada ainult vajalikud kasutajad sudo gruppi. Eemalda sudo √µigused tavakasutajatelt.
- **Kasuta tugevaid paroole**: M√§√§ra keerulised paroolid (v√§hemalt 12 t√§hem√§rki, sega suur- ja v√§iket√§hti, numbreid, s√ºmboleid). Kasuta t√∂√∂riistaid nagu `passwd` parooli muutmiseks.
- **Monitoori logisid**: Kontrolli `/var/log/auth.log` kahtlase tegevuse (nt eba√µnnestunud login-katsed) jaoks.
- **Paigalda turvat√∂√∂riistad**: Kasuta SELinux v√µi AppArmor kernelimooduleid, et piirata protsesside √µigusi.

## 2. NMAP-Sk√§nnimise Kaitse (V√µrgu Uurimine)
NMAP-sk√§nnimine paljastab avatud porte ja teenuseid. Kaitse nii:
- **Kasuta firewalle**: Paigalda ja konfigureeri UFW (`sudo apt install ufw`, `sudo ufw enable`) v√µi iptables, et blokeerida mittevajalikud pordid (nt sulge port 22 SSH, kui pole vaja).
- **Piira avatud porte**: Kontrolli ja sulge tarbetud teenused (nt `sudo systemctl stop ssh`, kui SSH pole vajalik). Kasuta `netstat -tuln` portide kontrollimiseks.
- **Rakenda port knocking**: Kasuta t√∂√∂riistu nagu knockd, et avada porte ainult kindla j√§rjestusega pakkidega.
- **Uuenda ja monitoori**: Hoidke OS ja teenused uuendatud. Kasuta t√∂√∂riistu nagu fail2ban, et blokeerida sk√§nnivaid IP-sid.
- **Kasuta VPN-i v√µi segmenteerimist**: Segmenteeri v√µrk VLAN-idega, et piirata juurdep√§√§su.

## 3. Metasploit phpMyAdmin Brute Force Kaitse (Andmebaasi R√ºnnak)
Brute force r√ºnnakud phpMyAdmin vastu v√µivad leida paroole. Kaitse nii:
- **Keela brute force**: Paigalda CAPTCHA v√µi rate limiting (nt mod_security Apache jaoks). Piira login-katseid (maksimaalselt 5 katset minutis).
- **Uuenda phpMyAdmin**: K√§ivita `sudo apt update && sudo apt upgrade`, et paigaldada uusim versioon turvapaikadega.
- **Kasuta tugevaid paroole**: M√§√§ra keerulised paroolid andmebaasi ja WordPressi jaoks. √Ñra kasuta vaikimisi paroole (nt "root").
- **Piira juurdep√§√§su**: Konfigureeri phpMyAdmin ainult kohalikust v√µrgust (nt `.htaccess` failiga) v√µi kasuta VPN-i.
- **Monitoori logisid**: Kontrolli `/var/log/apache2/access.log` kahtlase tegevuse jaoks. Kasuta t√∂√∂riistu nagu OSSEC IDS.

## 4. Hashcat Paroolikrakkimise Kaitse (Parooli Turvalisus)
Hashitud paroolide krakkimine on lihtne n√µrkade paroolidega. Kaitse nii:
- **Kasuta tugevaid paroole**: Rakenda paroolipoliitikat (pikkus, keerukus). Kasuta paroolihaldureid.
- **Rakenda hashimine**: Kasuta tugevaid hash-funktsioone (nt bcrypt v√µi Argon2) WordPressis ja andmebaasis. V√§ltige MD5-d.
- **Uuenda s√ºsteemi**: Hoidke tarkvara uuendatud, et v√§ltida haavatavusi.
- **Kasuta mitmefaktorilist autentimist (MFA)**: Lisa MFA WordPressi ja SSH jaoks.
- **Monitoori ja auditeeri**: Kontrolli paroole regulaarselt t√∂√∂riistadega nagu John the Ripper (kaitseks, mitte r√ºnnakuks).

## 5. SSH Brute Force Kaitse (SSH Login R√ºnnak)
SSH brute force v√µib anda juurdep√§√§su serverile. Kaitse nii:
- **L√ºlita √ºle v√µtme-p√µhisele autentimisele**: Keela parooli-p√µhine login (`sudo nano /etc/ssh/sshd_config`, sea `PasswordAuthentication no`). Genereeri SSH-v√µtmed (`ssh-keygen`).
- **Paigalda fail2ban**: `sudo apt install fail2ban`, konfigureeri see SSH jaoks, et blokeerida IP-sid p√§rast mitut eba√µnnestunud katset.
- **Muuda vaikimisi port**: Muuda SSH-port (nt 2222) `/etc/ssh/sshd_config` failis, et v√§ltida automaatseid sk√§nne.
- **Kasuta tugevaid paroole ja MFA**: Kui parooli-p√µhine on vajalik, lisa MFA t√∂√∂riistadega nagu Google Authenticator.
- **Uuenda ja monitoori**: Hoidke OpenSSH uuendatud. Kontrolli logisid `/var/log/auth.log`.

Rakenda need sammud j√§rk-j√§rgult ja testi keskkonda, et tagada turvalisus. Kui vaja, konsulteeri IT-turbe ekspertidega.
