# Digitaalse Forensika Uurimisraport: TRL-Win10-02
**Kuupäev:** 18.11.2025
**Uurija:** [Sinu Nimi]
**Juhtumi tüüp:** Andmete eksfiltratsioon ja lunavara ettevalmistus

---

## 1. Esmane vaatlus ja anomaaliad
* **Kasutaja märguanne:** Pille Porgand märkas sisselogimisel "vilkuvaid aknaid" (PowerShell).
* **Töölaua anomaalia:** Failisüsteemis (`C:\Users\Pille\Desktop`) on vaid 2 faili, kuid ekraanil kuvatakse arvukalt ikoone. See viitab peidetud failidele või muudetud `Public\Desktop` asukohale.
* **Kahtlane sisu:** Kasutaja `Documents` kaustast leiti u 20 skripti, mis on seotud BitLockeriga.

---

## 2. PowerShell Transkriptide Analüüs (Kriitiline tõend)

Uurimise käigus tuvastati kaustast `...\Documents\20251118\` kokku **24 PowerShell transkripti faili**. Need failid salvestasid ründaja tegevuse reaalajas.

### A. Metoodika
Kõigi failide sisu kiireks analüüsimiseks ja ründevektori tuvastamiseks kasutati järgmist PowerShell mass-otsingu käsklust:

```powershell
Select-String -Path "C:\Users\Kasutaja\Documents\20251118\*.txt" -Pattern "bitlocker", "E:", "http", "net use", "KAPE"
```
B. Analüüsi tulemused

Käskluse väljund ja failide (...2123.txt, ...2127.txt jne) süvaanalüüs paljastas järgmise:
Leid	Detailne kirjeldus
KAPE Tööriist	Ründaja käivitas KAPE.exe (Kroll Artifact Parser and Extractor) süsteemi artefaktide pakkimiseks ja varguseks.
Andmete vargus	Tuvastati andmete kopeerimine asukohta E:\Capture\KAPE\Evidence\Output\.
E: Ketta staatus	Transkriptides esinevad ObjectNotFound vead kinnitavad, et ründaja kasutas ajutist võrguketast (E:), mis eemaldati pärast andmete kopeerimist.
C2 Sidekanal	Failis ...2123.txt tuvastati koodiread aC2URL ja oXMLHTTP.send(). See on Command & Control side, mis saatis andmeid üle HTTP POST päringute ründaja serverisse.
Võrguluure	Kasutati käske Get-NetTCPConnection ja Get-SMBMapping, et kaardistada sisevõrku ja leida uusi sihtmärke.
3. Tuvastatud ründeahel (Kill Chain)

    Sisenemine: Kasutati Pille sessiooni (võimalik sisselogimine teisest masinast).

    Andmete kogumine: Süsteemiinfo ja failide pakkimine KAPE abil.

    Eksfiltratsioon: Andmete suunamine ajutisele E: kettale ja paralleelne saatmine C2 serverisse.

    Püsivus (Persistence): Automaatselt käivituvad skriptid (Startup), mis põhjustavad akende vilkumist.

    Jälgede segamine: E: ketta lahtiühendamine ja tõenäoline logide puhastamise katse.

4. Tegevusplaan (Päev 2)

Järgmised sammud on suunatud ründaja serveri ja taastevõtmete tuvastamisele:

    [ ] Tuvastada aC2URL täpne aadress failist ...2123.txt.

    [ ] Leida E: ketta algne võrgutee (RemotePath), et tuvastada ründaja teine kontrollitav masin.

    [ ] Otsida BitLockeri taastevõtit (Recovery Key) viimastest transkriptidest, et ennetada failide kadu.

    [ ] Kontrollida Startup/Registry sätteid, et peatada pahavara automaatkäivitus.
