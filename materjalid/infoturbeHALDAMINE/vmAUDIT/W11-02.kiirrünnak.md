Siin on sulle "Kiirrünnaku skript" (Quick Response Script). See on kokku pandud nii, et saaksid selle kohe kopeerida ja käivitada hetkel, kui masin uuesti pildi ette võtab.

See skript teeb kolme asja korraga: peatab kahtlased protsessid, tuvastab ründaja serveri aadressi ja otsib üles BitLockeri võtme, enne kui masin uuesti sulguda jõuab.
1. Kopeeri see "Päästeskript" (PowerShell)
PowerShell

# --- 1. SEISKA KAHTLASED PROTSESSID (et masin ei sulguks) ---
Get-Process | Where-Object { $_.Path -like "*Documents*" -or $_.Path -like "*Temp*" } | Stop-Process -Force -ErrorAction SilentlyContinue

# --- 2. TUVASTA RÜNDAJA IP JA URL (C2) ---
Write-Host "`n[!] OTSIN RÜNDAJA AADRESSE..." -ForegroundColor Cyan
Select-String -Path "$env:USERPROFILE\Documents\20251118\*.txt" -Pattern "http", "aC2URL" | Select-Object -First 5 Line

# --- 3. OTSI BITLOCKERI TAASTEVÕTIT ---
Write-Host "`n[!] OTSIN BITLOCKER VÕTET..." -ForegroundColor Yellow
Select-String -Path "$env:USERPROFILE\Documents\20251118\*.txt" -Pattern "\d{6}-\d{6}-\d{6}-\d{6}" | Select-Object -First 2 Line

# --- 4. LEIA E: KETTA VÕRGUTEE ---
Write-Host "`n[!] OTSIN E: KETTA ASUKOHTA..." -ForegroundColor Green
Select-String -Path "$env:USERPROFILE\Documents\20251118\*.txt" -Pattern "RemotePath", "net use" | Select-Object -First 3 Line

# --- 5. NÄITA AJASTATUD TÖID (MIS SULGEVAD MASINAT) ---
Write-Host "`n[!] AJASTATUD TÖÖD (SCHEDULED TASKS):" -ForegroundColor Red
Get-ScheduledTask | Where-Object {$_.State -ne "Disabled" -and $_.TaskPath -notlike "\Microsoft*"} | Get-ScheduledTaskInfo | Select-Object TaskName, LastRunTime

2. Sinu tegevusplaan (Kui masin startis)

    Logi sisse.

    Ava PowerShell (Admin).

    Kleebi ülaltoodud skript ja vajuta Enter.

    Tee ekraanist kohe pilt, sest isegi kui skript midagi peatab, võib ründaja "Watchdog" masina ikkagi uuesti maha murda.

3. Täielik Markdown Raport (Kõik senised leiud)

Kopeeri see kood oma lõplikku faili. See on nüüd täielikult süstematiseeritud.
Markdown

# FORENSIC ANALYSIS REPORT: TRL-Win11-02
**Case ID:** 2026-02-06-INCIDENT
**Investigator:** [Sinu Nimi]
**Summary:** Tuvastatud on kaugele arenenud "Living off the Land" rünnak, mis kasutab Windowsi sisse-ehitatud tööriistu andmete varguseks ja süsteemi lukustamiseks.

---

## 1. Tuvastatud Tõendid (PowerShell Logid)
Uurimise käigus leiti 24+ PowerShell transkripti, mis kinnitavad ründaja tegevust sekundilise täpsusega.
* **Timestamp format:** `PowerShell_transcript.TRL-WIN11-02.[ID].YYYYMMDDHHMMSS.txt`
* **Viimane logitud tegevus:** 2026-02-06 12:09:41.
* **Käitumine:** Süsteem logib automaatselt ründaja (ja uurija) käske reaalajas.

## 2. Tehniline Analüüs
### A. Tööriistad ja Meetodid
* **KAPE.exe:** Kasutati artefaktide pakkimiseks asukohta `E:\Capture\KAPE\`.
* **C2 Sidekanal:** Tuvastatud muutuja `aC2URL` ja funktsioon `oXMLHTTP.send()`. Andmed edastatakse üle HTTP POST.
* **BitLocker:** Leitud ~20 skripti BitLockeri haldamiseks; viiteid sunnitud krüpteerimisele.

### B. Offline-Püsivus (Persistence)
* Masin jätkab logimist ja skriptide käivitamist ka ilma võrguühenduseta.
* Perioodiline sunnitud sulgumine (Shutdown) viitab ründaja "Watchdog" mehhanismile, mis tuvastab uurija tegevust.

## 3. Forensilised Käsklused (Audit Trail)
Kasutati järgmisi meetodeid ründe ulatuse tuvastamiseks:
```powershell
# Ründaja IP-de ja URL-ide otsing
Select-String -Path "*.txt" -Pattern "http", "aC2URL"

# BitLocker taastevõtme tuvastamine
Select-String -Path "*.txt" -Pattern "\d{6}-\d{6}-\d{6}-\d{6}"

# Aktiivsete ründeprotsesside peatamine
Stop-Process -Name "powershell" -Force (v.a. uurija sessioon)

4. Järeldused ja Ohu tase

Kriitiline. Ründaja kontrollib masinat läbi ajastatud ülesannete. On suur risk, et järgmise käivituse ajal aktiveerub BitLocker ja failid muutuvad kättesaamatuks.
