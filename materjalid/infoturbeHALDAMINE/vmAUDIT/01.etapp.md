# 01. etapp: Logifailide analüüs

Keskendub kättesaadavate `.evtx` logifailide automatiseeritud töötlemisele ja anomaaliate tuvastamisele kõigis võrgu sõlmedes.

## I. Paigaldus ja ettevalmistus

Enne skriptide kasutamist on vaja paigaldada vajalikud tarkvarakomponendid ja tagada tööriistade olemasolu analüüsimasinas.

### 1. Pythoni keskkond
Kõigi analüüsi skriptide käivitamiseks on vajalik Python 3. Skriptid kasutavad Pythoni standardraamatukogu mooduleid (`re`, `os`, `subprocess`, `datetime`), mis ei vaja eraldi paigaldust.
Veendu, et Python on paigaldatud ja PATH-is:
```bash
python3 --version
```

### 2. `evtxexport` tööriist
Skript `extract_evtx_to_text.py` kasutab `.evtx` failide teisendamiseks tekstivormingusse `evtxexport` tööriista. See tööriist peab olema paigaldatud ja süsteemi PATH-is kättesaadav.

**Debian/Ubuntu-põhistes süsteemides paigaldamine:**
```bash
sudo apt update
sudo apt install libevtx-utils
```
**Windowsis paigaldamine:**
Laadi alla ja paigalda `evtxexport` (osa `libevtx`) vastavalt dokumentatsioonile. Tihti on see saadaval nt `Eric Zimmerman's EvtxExplorer` komplektis või iseseisva binaarfailina. Veendu, et selle asukoht oleks süsteemi PATH-is või täpsusta skriptis täisteed.

## Metoodika
Analüüs viiakse läbi Pythoni skriptide abil, mis teisendavad binaarsed logid tekstivormingusse ja filtreerivad välja kriitilised sündmuse ID-d (Event ID).

### Analüüsitavad logid
* **TRL-DC01**: Turvalogid (Security.evtx).
* **TRL-INFRA01**: Turva-, süsteemi- ja rakenduslogid (Security, System, Application).
* **TRL-WIN10-01**: Tööjaama sündmuselogid intsidendi perioodil.

### Fookusvaldkonnad ja Event ID-d
* **Kontode haldus**:
    * `4720`: Kasutajakonto loomine.
    * `4732`: Kasutaja lisamine turvapiirangutega gruppi.
* **Autentimine**:
    * `4624/4625`: Edukad ja ebaõnnestunud sisselogimised (Logon Type 3 ja 10).
* **Protsessid ja süsteem**:
    * `4688`: Uue protsessi loomine (käsurea parameetritega).
    * `6008`: Süsteemi ootamatu väljalülitamine.

### Kasutatavad skriptid
*   `extract_evtx_to_text.py`: Konverteerib binaarsed `.evtx` failid loetavaks tekstivorminguks.
    *   **Kasutus:** `python3 extract_evtx_to_text.py <sisend_evtx_fail> <väljund_teksti_fail>`
*   `analyze_security_logs.py`: Analüüsib turvalogisid (nt TRL-INFRA01 Security.evtx), otsides ebaõnnestunud/edukaid sisselogimisi, kahtlasi protsesse ja teatud sündmuse ID-sid.
    *   **Kasutus:** `python3 analyze_security_logs.py <sisend_teksti_fail> <väljund_leidude_fail> [intsidendi_kuupäev]`
*   `analyze_system_logs.py`: Analüüsib süsteemiloge (nt TRL-INFRA01 System.evtx), tuvastades süsteemi väljalülitamisi ja kriitilisi vigu/hoiatusi.
    *   **Kasutus:** `python3 analyze_system_logs.py <sisend_teksti_fail> <väljund_leidude_fail> [intsidendi_kuupäev]`
*   `analyze_earlier_dc_logs.py`: Analüüsib domeenikontrolleri varasema perioodi logisid, otsides kahtlast tegevust.
    *   **Kasutus:** `python3 analyze_earlier_dc_logs.py <sisend_teksti_fail> <väljund_leidude_fail> <alguskuupäev_format_MMM_DD_YYYY> <lõppkuupäev_format_MMM_DD_YYYY>`
*   `analyze_infra01_application_logs.py`: Analüüsib rakendusserveri rakendusloge, otsides rakendusvigu ja teenuse väljalülitamisi.
    *   **Kasutus:** `python3 analyze_infra01_application_logs.py <sisend_teksti_fail> <väljund_leidude_fail> [intsidendi_kuupäev]`
*   `search_win10_downloads.py`: Otsib Windows 10 logifailidest konkreetseid allalaadimisi.
    *   **Kasutus:** `python3 search_win10_downloads.py` (Märkus: Konfigureeritav skripti sees).
```
